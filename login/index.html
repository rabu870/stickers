<!DOCTYPE html>
<html>

<head>
    <title>PSCS Stickering Login</title>
    <meta name='viewport'>
    <link href='../assets/media/favicon.ico' type='image/x-icon' rel='shortcut icon'>

    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <meta name="google-signin-client_id" content="570971308489-6golgnijuhqlvon7s2av7getpv2j4h4d.apps.googleusercontent.com">
    <script src='../assets/scripts/libraries/axios.min.js'></script>
    <script src='../assets/scripts/libraries/sweetalert.min.js'></script>

    <link href='../assets/css/libraries/spectre.min.css' rel='stylesheet' type='text/css'>
    <link href='../assets/css/libraries/spectre-icons.min.css' rel='stylesheet' type='text/css'>
    <link href='../assets/css/main.css' rel='stylesheet' type='text/css'>
</head>

<body style='background-color: #f7f8f9'>
    <div class="empty center">
        <div class="empty-icon">
          <i class="icon icon-3x icon-people"></i>
        </div>
        <p class="empty-title h5"><div class="g-signin2" style='display: inline-block;' data-onsuccess="onSignIn"></div><br>to PSCS stickering</p>
      </div>

    <script>
        function onSignIn(googleUser) {
            var id_token = googleUser.getAuthResponse().id_token;
            gapi.auth2.getAuthInstance().disconnect().then(function () {
                axios.get('./authenticate.php?idtoken=' + id_token)
                .then(function(response) {
                    if(response.data == '1') {
                        window.location.href = '../admin.html';
                    } else if (response.data == '2') {
                        window.location.href = '../';
                    } else if (response.data == '3') {
                        Swal.fire({
                            title: 'It seems you\'re not in our database.',
                            text: 'Please try a different email.',
                            type: 'error',
                            confirmButtonText: 'OK'
                        });
                    } else {
                        Swal.fire({
                            title: 'Google doesn\t think you\'re legitimate.',
                            text: 'Please try again.',
                            type: 'error',
                            confirmButtonText: 'OK'
                        });
                    }
                });
            });
        }
    </script>
</body>

</html>